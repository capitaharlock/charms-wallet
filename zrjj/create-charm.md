
# *** Protocol ***

# set environment
alias b=bitcoin-cli
export SP1_PROVER=network
export NETWORK_PRIVATE_KEY="0x7428aa5cb240c2f1bcbba1163428405fb7deea94b83825c465af29937c097e71"

# destination address (a new utxo with charm will be created)
export addr_0="tb1qxk5jszesz24z2jxpukuvtdu35ht2cwvks36j7t"

# input utxos (availabel in your wallet)
export in_utxo_0="86e2bcbfb0625db821ebd9daa4c935fd465575819f7d5a96388c63bc11fa2555:1"
export funding_utxo_id="e5b39ea36ccf1af3f213ab7b24c7944d564a3378d4cada291974ff0a0ce7f7c1:1"

# create the app
charms app new charms-3
cd charms-3
export app_vk=$(charms app vk)
export app_id=$(echo -n "${in_utxo_0}" | sha256sum | cut -d' ' -f1)

# 
cat ./spells/mint-nft.yaml | envsubst | charms app run
app_bins=$(charms app build)
cat ./spells/mint-nft.yaml | envsubst | RUST_LOG=info charms wallet cast --app-bins=${app_bins} --funding-utxo-id=${funding_utxo_id}

# Broadcast (sample signed 2 t hex-encoded output)
b submitpackage '["020000000001015f...57505efa00000000", "020000000001025f...e14c656300000000"]'



# Real example will look like this:
b submitpackage '["02000000000101c1f7e70c0aff741929dacad478334a564d94c7247bab13f2f31acf6ca39eb3e50100000000ffffffff0142a0070000000000225120f9f07fc5b2498d8667991655e34277e3c439fd39d1f27fb10c6f04f2e46a7dd80247304402203bbf0b55123bbe5fab58fad4e61baf0fabc56e8177972d7eed69720f11871046022048e2b787bff07459f38d938eaf823f16d46328e7fca4a592bf7a031a89b68c94012103f9e5524f2b5716fa5c6c4067cb920ae61c80aa1dd28a9e6c9b9c95b30a9c858200000000","020000000001025525fa11bc638c38965a7d9f81755546fd35c9a4dad9eb21b85d62b0bfbce2860100000000ffffffffb2fd652751b3c0be99c80185279fcf1b6c0932b3ba12e5389d284fb9fa0e6acb0000000000ffffffff02e80300000000000016001435a9280b3012aa2548c1e5b8c5b791a5d6ac3996863a0f000000000022512052c693d8e1e2bc5f49620a1023299c9adeb77eb8b23805fdb24e90990b31d1ae0247304402203679a704a5f676f7f18c5cc624580891cabd0d3a8702358c5eb548e250e6a081022026507339e42d18fee746b848847bc0033d4a414819c4993f0efbf478ce2b1866012103f9e5524f2b5716fa5c6c4067cb920ae61c80aa1dd28a9e6c9b9c95b30a9c85820341ae53a6e3d44eb01567ee13d52b34c1f2e2635817d442c5239ad009c021d992f032f4894b00c5b3e2d01b7f8183d6b386b04c391cfd6dbd1ec8812a445e0d548f81fdf0020063057370656c6c4d080282a36776657273696f6e01627478a2647265667380646f75747381a100a2667469636b657268434841524d532d336972656d61696e696e671a000186a0716170705f7075626c69635f696e70757473a183616e9820184118e1184b186f1875187718d9184018531893186b18421897183e182218b818c71899187d18a81872185e18961845185f1886182318471823182c189918a9982018e418ab183c18650d18310f1818186c1886150a18cb18f71844185418b50c18d0182c18b818f6188b0718c8184518fb1830188e183418f3185ff69901041118b618a0189d170e18c918a6188f18ef06188018c218d8181d00187718461823186b186e181d18a518ae18f218d5182518e11847187918ed184f187b18cf189a184518271887185618d318e3186c18b318ed10181d18981718a1182418b6188318a80618a918e1184418b7188b185c184c1873186518871882186818ee187d160a1896186918ff189318a1188118b818ac18d218be189c18c318a3188318dd1881188c18950c188818cd183915187e181a18fc18fb183a1847184c18241849182618561844071819182a18b518a6188c18d81889185c18601818181918b2188b184118f7184d18fd183e182218dc18540e18c718f21882182c0c183a18ef18e018e418ce185318ca04187d189d187318a7182f1829182e18bf18ec1857181e18ef186a1862187818b11882182018e518e5184cb81a181b18de181e186718c218ac183a182e181b18a602185118d018d318af187d1898188a18cc181f186518de182f181c186d15185b0d189d03183d01181f1843182b186c1863131879182618e418ee184b187c0a185d189a18e218dd18f818a1187918d9189618261822141858184718df186f04181e18191878182d0618ec18961875185b182818ce184e18af188d18be18ae183f18c718c90f185418df18b918f918cf187018510d1835185b181818da18c41518b818ba682000a669a7a0df1f8c8a8c59b46353d5ffc2c8aa3afedb76a8956f1204cb8c2a4aac21c000a669a7a0df1f8c8a8c59b46353d5ffc2c8aa3afedb76a8956f1204cb8c2a4a00000000"]'